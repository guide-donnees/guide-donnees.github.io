# Préparer les données

Cette phase du cycle de vie des données correspond au pré-traitement des données brutes issues des acquisitions et des collectes.
Il s'agit souvent de regrouper, choisir, qualifier les données pertinentes, les reformater dans des formats standards interopérables, et les organiser en vue de leur analyse.

Cette partie est donc structurer en différentes sections décrivant cette préparation des données :

- Préparer les fichiers de données, en vue de leur analyse, en utilisant des formats interopérables
- Organiser les données à travers des collections de données (la partie base de données est abordée dans le chapitre "Concevoir et planifier")
- Mettre en place ou utiliser des plateformes de gestion de données locales, en vue de leur analyse
- Utiliser des framework d'intégration de données si besoin lorsqu'elles sont hétérogènes



## Préparer les fichiers de données en vue de leur analyse

**Mise en forme des données dans des formats standards, interopérables**

Bien souvent, les données primaires sont issus d'instruments, de collecte sur le terrain, ... et se présentent sous la forme de fichiers aux formats propriétaires ou peu interopérables.

Le site Doranum propose une [introduction à la définition de formats ouverts ou fermés](https://doranum.fr/stockage-archivage/quiz-format-ouvert-ou-ferme/).

De plus, si l'objectif est le traitement massif des données, il est important de choisir des formats capables de supporter des entrées / sorties intensives sur des infrastructures de calcul.

### Le format NetCDF

Le format  de fichier [NetCDF](https://www.unidata.ucar.edu/software/netcdf/) est un format ouvert, auto-documenté et très utilisé en particulier dans les communautés sciences de l'environnement par exemple en océanographie, météorologie, atmosphère.

Parmi les premiers traitements opérés sur des données brutes provenant du terrain, on doit fréquemment filtrer, extraire les données utiles dans des fichiers issus des acquisitions par des capteurs qui sont souvent peu exploitables dans leur état originel.

Les données issues de capteurs environnementaux sont fréquemment dans des formats propriétaires, souvent illisibles et peu exploitables par un être humain. Il convient alors de traiter les fichiers bruts de manière à en extraire les données utiles et les réécrire dans des formats standards utilisables par un grand nombre de logiciels, et une communauté d'utilisateurs

Le format NetCDF est particulièrement adapté et permet d'insérer les métadonnées qui sont véhiculées dans le fichier avec les données elles mêmes.
On peut ainsi décrire de manière assez précise les données du fichier, par exemple en insérant les unités de mesure, la licence, les propriétaires etc, ainsi que l'organisation des données, sans avoir besoin d'un fichier de description complémentaire. 

Toutefois le format n'impose rien et on peut y mettre ce qu'on veut, et donc une standardisation des métadonnées NetCDF est utile et nécessaire. 

Dans le domaine du climat par exemple, il est recommandé d'utiliser la [convention CF (climate forecast)](https://cfconventions.org/) qui permet de standardiser autant que faire se peut les métadonnées inscrites dans une entête NetCDF.

Ce format est préconisé par le pôle de données Odatis et a été présenté au séminaire SIST19 à l'OMP de Toulouse, par Joel Sudre, maurice Libes et Didier Mallarino :

* [Présentation du format NetCDF](<https://sist19.sciencesconf.org/data/pages/SIST19_Atelier_NetCDF_JS.pdf>)
  * Joël Sudre, LEGOS
* [La convention CF (climate forecast) pour les fichiers NetCDF](https://sist19.sciencesconf.org/data/pages/SIST19_Atelier_NetCDF_CF_ML.pdf)
  * Joël Sudre, LEGOS et Maurice Libes, Institut Phyteas
* [Utilisation de l'API de programmation Python pour NetCDF](<https://sist19.sciencesconf.org/data/pages/SIST19_Atelier_NetCDF_python.pdf>)
  * Maurice Libes, Didier Mallarino, Institut Phyteas 

Le format ODV (ocean data view) [https://odv.awi.de/](https://odv.awi.de/)  est également un format standard intéressant. Il se rapproche d'un format CSV i.e des colonnes de données séparées par des virgules (ou tout autre séparateur), à cette différence près que le format ODV permet l'insertion d'une entête assez riche permettant de placer des métadonnées en début de fichier.

Les formats NetCDF et ODV sont les formats recommandés et utilisés par le pôle de données Odatis  <https://www.odatis-ocean.fr/donnees-et-services/principes-de-gestion-des-donnees/formats-attributs-conventions> et par le projet Européen Seadatanet <https://www.seadatanet.org/>.

### Le format HDF5

Le format [HDF5](https://www.hdfgroup.org/solutions/hdf5/) (Hierarchical Data Format, version 5) est un format de fichier de type conteneur, c'est-à-dire assimilable à une arborescence de dossiers / fichiers contenu dans un même fichier.

C'est un format très utilisé lorsqu'on veut traiter ou simuler des données grâce au calcul intensif car il offre des possibilité de compression et d'écriture / lecture parallèles très intéressantes.

Des supports de formation sur ce format sont donc disponibles via les infrastructures et réseaux en lien avec le calcul intensif :

- HDF5 : theory & practice [1](https://materials.prace-ri.eu/386/6.haslightboxThumbnailVersion/hdf51.pdf) et [2](https://materials.prace-ri.eu/386/7.haslightboxThumbnailVersion/hdf52.pdf)
  - Prace Advanced Training Centers, [Course: Parallel I/O and management of large scientific data, 2014](https://materials.prace-ri.eu/386/)



~~**Retours d'expériences dans le traitement des données**~~

* ~~Collecte de mesures météorologiques à l'aide d'un système autonome : exemple de la métropole rennaise (Zone Atelier Armorique)           
  <https://sist15.sciencesconf.org/program> (mettre le lien exact vers le fichier)~~
  ~~Alban Thomas, Littoral, Environnement, Télédétection, Géomatique~~    

* ~~Outil web interactif de visualisation et validation de séries temporelles.~~
  ~~<https://sist15.sciencesconf.org/program> (mettre le lien exact vers le fichier)~~
  ~~Olivier LOBRY, Observatoire de REcherche Méditerranéen de l'Environnement   
       *~~ 
* ~~SI-TEC-PSO: retour d'expérience sur le système d'information dédié capteurs et reconstitution de séries temporelles de ReefTEMPS, le réseau de suivi de température des eaux côtières dans la région du Pacifique Sud et Sud-Ouest~~ 
  ~~<https://sist15.sciencesconf.org/program> (mettre le lien exact vers le fichier)~~
  ~~Sylvie Fiat, et  Régis Hocdé, Institut de Recherche pour le Développement~~
  ~~~~          

~~Thierry Valero donne un exemple d'utilisation de Erddap~~

* ~~Copier les succès et rester simple (AMEO) : Mise à disposition de sorties de modèles climatiques avec un NAS, THREDDS et ERDDAP~~
  ~~<https://sist16.sciencesconf.org/data/pages/11\_T\_Valero\_F\_Bongat.pdf>~~
  ~~Thierry VALERO, Institut de Recherche pour le Développement, Laboratoire   d'Océanographie et du Climat : Expérimentations et Approches Numérique~~

* ~~Réseau d'observation du Pacifique Sud ‘ReefTEMPS' : évolutions fonctionnelles et optimisation d'un système d'information dédié capteurs et reconstitution de séries temporelles                   
  <https://sist16.sciencesconf.org/data/pages/12\_R\_Hocde.pdf>                     
  Régis Hocdé, Institut de Recherche pour le Développement~~


### 

## Organiser les données

### Utiliser un framework d’agrégation de données

Lorsque les données à traiter sont hétérogènes et que les technologies qui permettent de les fournir sont également différentes, une solution est d'utiliser un framework d’agrégation de données comme Lavoisier. 

Ce logiciel, développé au CC-IN2P3, permet de récupérer, transformer,  fusionner, et requêter des données de sources différentes. 

- [Lavoisier : un framework d'agrégation de données](https://jcad2018.sciencesconf.org/data/jcad2018_lavoisier_2_.pdf),  [vidéo de la présentation](https://webcast.in2p3.fr/video/lavoisier-un-framework-dagregation-de-donnees-1)
  - Cyril L'Orphelin, Sylvain Reynaud, CC-IN2P3, CNRS
  - JCAD 2018

D'autres outils existent, permettant l'intégration de données, dans la catégorie des ETL (Extract, Transform, Load). Le logiciel Talend Open Studio par exemple, a été abordé lors d'une session de formation du réseau RBDD :

- ["Utilisation et maîtrise d'un ETL : intégrations de données avec Talend Open Studio"](http://rbdd.cnrs.fr/spip.php?article215)
  - Réseau RBDD, 2017

### La gestion des collections 

Collec-Science (https://www.collec-science.org) est un logiciel web qui a été créé pour suivre les échantillons collectés lors des campagnes d’acquisition, et permet de répondre, entre autres, à ces questions :
    -   où est stocké l’échantillon ?
        -   d’où vient-il, quelle est sa généalogie (protocole de collecte, métadonnées associées à l’échantillon et ceux de ces ancêtres) ?
            -   quelles transformations ou opérations a-t-il subi ?
                -   sous quelle forme est-il conservé, existe-t-il un risque à le manipuler ?

Fruit d’une collaboration initiale entre Irstea (centre de Bordeaux), le laboratoire Epoc à Bordeaux, le LIENSs à La Rochelle, il a été enrichi avec la participation de nombreux autres laboratoires, dont les laboratoires Chrono-environnement à Besançon, Edytem à l’Université Savoie - Mont Blanc, etc. Il a été choisi par le Réseau des Zones Ateliers pour assurer le suivi des échantillons.
* [Stockez et retrouvez vos échantillons avec Collec-Science] (http://rbdd.cnrs.fr/spip.php?article304)
Marie-Claude Quidoz
## Développer les procédures d'intégration des données dans les bases de données                       
[ML: manque du texte explicatif et introductif ici]

*  [Intégrer les données dans sa base métier](http://rbdd.cnrs.fr/IMG/pdf/integrer_donnees.pdf?570/2006217c4509e4d59e6cbf44a291f997e7500153) 
MC. Quidoz 


*  [UUID avec PostgreSQL : Pourquoi ? Comment ?](http://rbdd.cnrs.fr/IMG/pdf/uuid_postgres.pdf?405/e6315023727441ee71c5d63415dd28285bc24952) 
N. Raidelet

*  [Les avantages et les inconvénients de la solution ODK](http://rbdd.cnrs.fr/IMG/pdf/bilan_odk.pdf?579/014d2664a47a1b155dde7a4ce7cf84db388194fa) 
MC. Quidoz \& PY. Arnould \& les stagiaires

*  [Référence sur ODK](http://rbdd.cnrs.fr/IMG/pdf/bibliographie.pdf?571/bbecc7bd883e4751efb6ccba6f99517ded5a6305) 
MC. Quidoz

*  [Outils nomades : validation des données](http://rbdd.cnrs.fr/IMG/pdf/anf_rbbd_2019_outils_mobiles_tp_qualite.pdf?573/e1425561fd10c6bd1dd92fdee22871bc427f9873) 
C. Plumejeaud

*  [Retour terrain : la délicate question de l’intégration des données](http://rbdd.cnrs.fr/IMG/pdf/anf2019_seshat.pdf?576/575888582b8771a01200c5a6a5e751f0964e0c33)
PY. Arnould



* 


### Déposer et structurer dans des plateformes de gestion de données locales

**Utilisation de plateformes d'accès aux données**




Les services informatiques de certains laboratoires de recherche et des OSU ("Observatoires des Sciences de l'Univers") ont pour vocation et pour mission d'intervenir dans la gestion des données d'observation acquises sur le terrain.  Après les phases de collecte et de transfert de données que nous avons vues dans les précédentes étapes du cycle de vie des données, il est nécessaire de se préoccuper de la facilité d'accès et de la réutilisation des données localement dans une unité de recherche.

Un certain nombre de logiciels font office de plateforme d'accès et de gestion des données. Ils permettent de présenter les données
avec leur métadonnées, de fournir des interfaces de recherche, de géolocaliser les données, et parfois de visualisation des données
avec des graphes

La gestion des données demande donc aux informaticiens concernés de développer des compétences dans des domaines très divers (gestion
de la production des données, organisation de la donnée, gestion de la géolocalisation, gestion de la donnée dans le temps, mise à
disposition et visualisation des données, modèle OAIS, ...).


Des logiciels sont particulièrement adaptés dans la diffusion et l'affichage des données scientifiques d'observation par le fait qu'ils
utilisent les standards interopérables de l'Open Geospatial Consortium (OGC), ISO19139, Inspire, etc)

*  le serveur cartographique *[Geoserver](http://geoserver.org/)* permet d'afficher et permettre les échanges de données géospatiales sur le web selon les standards (WMS, WFS, ...) de l'OGC ;
   
*  le logiciel *[GeoNetwork](https://geonetwork-opensource.org/)* permet de cataloguer les métadonnées de jeux de données selon la norme ISO 19139 et la directive Inspire;
   
*  l'application GeoCMS et [GeoOrchestra](https://www.georchestra.org/) permettant la visualisation de données géospatiales sur le web et de mettre en place une Infrastructure de Données Géographique (IDG) 
   
*  Les logiciels comme *Thredds* et [Erddap](https://coastwatch.pfeg.noaa.gov/erddap/index.html) sont des plateformes web de gestion de données particulièrement adaptées
*  pour rendre les données FAIR dans un établissement et faciliter la diffusion des données 

ERDDAP fournit un ensemble complet de fonctionnalités pour la gestion des jeux de données. Il permet :
* de lire et écrire des jeux de données dans de nombreux formats différents,
*     fournir un catalogue des jeux de données gérés par le serveur
*     d'afficher les metadonnées
*     d'interroger et filtrer les données au travers de formulaires,
*     de créer des graphiques et des cartes simples pour visualiser le jeu de données analysé
*     normaliser les unités de temps présentes dans les fichiers

Une des fonctionnalités intéressantes est que ERDDAP aggrège automatiquement les données nouvelles répondant a un format donné, et qui sont déposées dans un répertoire. Ainsi pour les séries temporelles cette fonctionnalité est intéressante puisqu'il suffit de déposer des fichiers dans un répertoire pour que la série temporelle soit automatiquement enrichie et constituée.

L'objectif est donc de faciliter l'affichage, l'accès et la mise à disposition de données scientifiques à travers des standards interopérables.

L'utilisation de ces logiciels a fait l'objet d'une  Action  nationale de formation du [réseau SIST](http://sist.cnrs.fr) qui permet de savoir installer, configurer et utiliser ces logiciels
   * [<https://sist.cnrs.fr/les-formations/supports-des-anf-gestion-de-donnees-dobservation>](<https://sist.cnrs.fr/les-formations/supports-des-anf-gestion-de-donnees-dobservation>)


* Distribution et visualisation de données avec Thredds, exemples d'utilisation au SEDOO
<https://sist15.sciencesconf.org/program> (mettre le lien exact vers le fichier)
Guillaume Brissebrat, Service de données de l'OMP

Eccad, un exemple de mise en oeuvre de Thredds - 
<https://sist19.sciencesconf.org/data/pages/SIST19_S_Darras.pdf>
Sabine Darras, Observatoire Midi-Pyrénées                                                                            


Les événements suivants fournissent  un certain nombre de connaissances sur l’utilisation d'infrastructure
de données géographiques (IDS, IDG) et de plateforme logicielles de gestion des données

*  infrastructure de données spatiales et de traitements GEOSUD : des standards à la réalité     
https://sist16.sciencesconf.org/data/pages/01_JC_Desconnets.pdf
Jean-Christophe Desconnets, UMR Espace-Dev 
   
* Publication automatique de données et de métadonnées dans *geOrchestra*
<https://sist18.sciencesconf.org/data/pages/19_E_Chiarello_GeOrchestra.pdf>
Ernest CHIARELLO, Théoriser et modéliser pour aménager

* OSUNA : Mise en place d'une IDS pour le programme de recherche Réseau de Suivi et de Surveillance de l'Environnement.
<https://sist16.sciencesconf.org/data/pages/02\_L\_Salaun.pdf>
LOIC SALAUN, Observatoire des Sciences de l'Univers Nantes Atlantique 

* Sextant, infrastructure de données géographiques marines et littorales
<https://sist16.sciencesconf.org/data/pages/03\_M\_Treguer.pdf>
Catherine Satra Le Bris, Ifremer - IDM/SISMER - Mickael Treguer, Ifremer    

* Copier les succès et rester simple (AMEO) : Mise à disposition de sorties de modèles climatiques avec un NAS, THREDDS et ERDDAP. 
<https://sist16.sciencesconf.org/data/pages/11\_T\_Valero\_F\_Bongat.pdf>
Thierry VALERO, Institut de Recherche pour le Développement, Laboratoire   d'Océanographie et du Climat : Expérimentations et Approches Numérique

